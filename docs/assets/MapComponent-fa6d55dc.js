import{$ as Me}from"./compat.module-b1a3416f.js";import{F as Oe,b as P,c as X,t as H,G as k,P as Fe,L as Ie,d as Ne,e as Ge,f as Qe,g as ke,M as Ae,u as De,h as Ue,B as je,D as Ke,a as Ye}from"./MapContainer-2e634ccc.js";import{p as K,q as O,h as ie,T as oe,F as L}from"./hooks.module-10a4f742.js";import{a as Be}from"./_commonjsHelpers-de833af9.js";import{y as z,G as I,k as $e}from"./preact.module-4f38c496.js";import{o as p}from"./jsxRuntime.module-8e7d8b33.js";class Y{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){const t={listener:e};return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}}const F=typeof window>"u"||"Deno"in window;function qe(){}function or(r,e){return typeof r=="function"?r(e):r}function Z(r){return typeof r=="number"&&r>=0&&r!==1/0}function Xe(r,e){return Math.max(r+(e||0)-Date.now(),0)}function He(r,e,t){return N(r)?typeof e=="function"?{...t,queryKey:r,queryFn:e}:{...e,queryKey:r}:r}function ar(r,e,t){return N(r)?[{...e,queryKey:r},t]:[r||{},e]}function ur(r,e){const{type:t="all",exact:s,fetchStatus:n,predicate:i,queryKey:o,stale:a}=r;if(N(o)){if(s){if(e.queryHash!==ze(o,e.options))return!1}else if(!ae(e.queryKey,o))return!1}if(t!=="all"){const h=e.isActive();if(t==="active"&&!h||t==="inactive"&&h)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||typeof n<"u"&&n!==e.state.fetchStatus||i&&!i(e))}function cr(r,e){const{exact:t,fetching:s,predicate:n,mutationKey:i}=r;if(N(i)){if(!e.options.mutationKey)return!1;if(t){if(A(e.options.mutationKey)!==A(i))return!1}else if(!ae(e.options.mutationKey,i))return!1}return!(typeof s=="boolean"&&e.state.status==="loading"!==s||n&&!n(e))}function ze(r,e){return((e==null?void 0:e.queryKeyHashFn)||A)(r)}function A(r){return JSON.stringify(r,(e,t)=>U(t)?Object.keys(t).sort().reduce((s,n)=>(s[n]=t[n],s),{}):t)}function ae(r,e){return ue(r,e)}function ue(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?!Object.keys(e).some(t=>!ue(r[t],e[t])):!1}function ce(r,e){if(r===e)return r;const t=W(r)&&W(e);if(t||U(r)&&U(e)){const s=t?r.length:Object.keys(r).length,n=t?e:Object.keys(e),i=n.length,o=t?[]:{};let a=0;for(let h=0;h<i;h++){const d=t?h:n[h];o[d]=ce(r[d],e[d]),o[d]===r[d]&&a++}return s===i&&a===s?r:o}return e}function D(r,e){if(r&&!e||e&&!r)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}function W(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function U(r){if(!V(r))return!1;const e=r.constructor;if(typeof e>"u")return!0;const t=e.prototype;return!(!V(t)||!t.hasOwnProperty("isPrototypeOf"))}function V(r){return Object.prototype.toString.call(r)==="[object Object]"}function N(r){return Array.isArray(r)}function le(r){return new Promise(e=>{setTimeout(e,r)})}function J(r){le(0).then(r)}function lr(){if(typeof AbortController=="function")return new AbortController}function ee(r,e,t){return t.isDataEqual!=null&&t.isDataEqual(r,e)?r:typeof t.structuralSharing=="function"?t.structuralSharing(r,e):t.structuralSharing!==!1?ce(r,e):e}class Ze extends Y{constructor(){super(),this.setup=e=>{if(!F&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),window.addEventListener("focus",t,!1),()=>{window.removeEventListener("visibilitychange",t),window.removeEventListener("focus",t)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var e;(e=this.cleanup)==null||e.call(this),this.cleanup=void 0}}setEventListener(e){var t;this.setup=e,(t=this.cleanup)==null||t.call(this),this.cleanup=e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()})}setFocused(e){this.focused!==e&&(this.focused=e,this.onFocus())}onFocus(){this.listeners.forEach(({listener:e})=>{e()})}isFocused(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)}}const he=new Ze,te=["online","offline"];class We extends Y{constructor(){super(),this.setup=e=>{if(!F&&window.addEventListener){const t=()=>e();return te.forEach(s=>{window.addEventListener(s,t,!1)}),()=>{te.forEach(s=>{window.removeEventListener(s,t)})}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var e;(e=this.cleanup)==null||e.call(this),this.cleanup=void 0}}setEventListener(e){var t;this.setup=e,(t=this.cleanup)==null||t.call(this),this.cleanup=e(s=>{typeof s=="boolean"?this.setOnline(s):this.onOnline()})}setOnline(e){this.online!==e&&(this.online=e,this.onOnline())}onOnline(){this.listeners.forEach(({listener:e})=>{e()})}isOnline(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine}}const fe=new We;function Ve(r){return Math.min(1e3*2**r,3e4)}function de(r){return(r??"online")==="online"?fe.isOnline():!0}class pe{constructor(e){this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}}function Je(r){return r instanceof pe}function hr(r){let e=!1,t=0,s=!1,n,i,o;const a=new Promise((f,y)=>{i=f,o=y}),h=f=>{s||(E(new pe(f)),r.abort==null||r.abort())},d=()=>{e=!0},u=()=>{e=!1},c=()=>!he.isFocused()||r.networkMode!=="always"&&!fe.isOnline(),v=f=>{s||(s=!0,r.onSuccess==null||r.onSuccess(f),n==null||n(),i(f))},E=f=>{s||(s=!0,r.onError==null||r.onError(f),n==null||n(),o(f))},x=()=>new Promise(f=>{n=y=>{const w=s||!c();return w&&f(y),w},r.onPause==null||r.onPause()}).then(()=>{n=void 0,s||r.onContinue==null||r.onContinue()}),g=()=>{if(s)return;let f;try{f=r.fn()}catch(y){f=Promise.reject(y)}Promise.resolve(f).then(v).catch(y=>{var w,m;if(s)return;const R=(w=r.retry)!=null?w:3,b=(m=r.retryDelay)!=null?m:Ve,S=typeof b=="function"?b(t,y):b,q=R===!0||typeof R=="number"&&t<R||typeof R=="function"&&R(t,y);if(e||!q){E(y);return}t++,r.onFail==null||r.onFail(t,y),le(S).then(()=>{if(c())return x()}).then(()=>{e?E(y):g()})})};return de(r.networkMode)?g():x().then(g),{promise:a,cancel:h,continue:()=>(n==null?void 0:n())?a:Promise.resolve(),cancelRetry:d,continueRetry:u}}function et(){let r=[],e=0,t=u=>{u()},s=u=>{u()};const n=u=>{let c;e++;try{c=u()}finally{e--,e||a()}return c},i=u=>{e?r.push(u):J(()=>{t(u)})},o=u=>(...c)=>{i(()=>{u(...c)})},a=()=>{const u=r;r=[],u.length&&J(()=>{s(()=>{u.forEach(c=>{t(c)})})})};return{batch:n,batchCalls:o,schedule:i,setNotifyFunction:u=>{t=u},setBatchNotifyFunction:u=>{s=u}}}const C=et();class tt extends Y{constructor(e,t){super(),this.client=e,this.options=t,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(t)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.currentQuery.addObserver(this),re(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return j(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return j(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(e,t){const s=this.options,n=this.currentQuery;if(this.options=this.client.defaultQueryOptions(e),D(s,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=s.queryKey),this.updateQuery();const i=this.hasListeners();i&&se(this.currentQuery,n,this.options,s)&&this.executeFetch(),this.updateResult(t),i&&(this.currentQuery!==n||this.options.enabled!==s.enabled||this.options.staleTime!==s.staleTime)&&this.updateStaleTimeout();const o=this.computeRefetchInterval();i&&(this.currentQuery!==n||this.options.enabled!==s.enabled||o!==this.currentRefetchInterval)&&this.updateRefetchInterval(o)}getOptimisticResult(e){const t=this.client.getQueryCache().build(this.client,e),s=this.createResult(t,e);return st(this,s,e)&&(this.currentResult=s,this.currentResultOptions=this.options,this.currentResultState=this.currentQuery.state),s}getCurrentResult(){return this.currentResult}trackResult(e){const t={};return Object.keys(e).forEach(s=>{Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(s),e[s])})}),t}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:e,...t}={}){return this.fetch({...t,meta:{refetchPage:e}})}fetchOptimistic(e){const t=this.client.defaultQueryOptions(e),s=this.client.getQueryCache().build(this.client,t);return s.isFetchingOptimistic=!0,s.fetch().then(()=>this.createResult(s,t))}fetch(e){var t;return this.executeFetch({...e,cancelRefetch:(t=e.cancelRefetch)!=null?t:!0}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(e){this.updateQuery();let t=this.currentQuery.fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(qe)),t}updateStaleTimeout(){if(this.clearStaleTimeout(),F||this.currentResult.isStale||!Z(this.options.staleTime))return;const t=Xe(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},t)}computeRefetchInterval(){var e;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(e=this.options.refetchInterval)!=null?e:!1}updateRefetchInterval(e){this.clearRefetchInterval(),this.currentRefetchInterval=e,!(F||this.options.enabled===!1||!Z(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||he.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(e,t){const s=this.currentQuery,n=this.options,i=this.currentResult,o=this.currentResultState,a=this.currentResultOptions,h=e!==s,d=h?e.state:this.currentQueryInitialState,u=h?this.currentResult:this.previousQueryResult,{state:c}=e;let{dataUpdatedAt:v,error:E,errorUpdatedAt:x,fetchStatus:g,status:f}=c,y=!1,w=!1,m;if(t._optimisticResults){const T=this.hasListeners(),G=!T&&re(e,t),Le=T&&se(e,s,t,n);(G||Le)&&(g=de(e.options.networkMode)?"fetching":"paused",v||(f="loading")),t._optimisticResults==="isRestoring"&&(g="idle")}if(t.keepPreviousData&&!c.dataUpdatedAt&&u!=null&&u.isSuccess&&f!=="error")m=u.data,v=u.dataUpdatedAt,f=u.status,y=!0;else if(t.select&&typeof c.data<"u")if(i&&c.data===(o==null?void 0:o.data)&&t.select===this.selectFn)m=this.selectResult;else try{this.selectFn=t.select,m=t.select(c.data),m=ee(i==null?void 0:i.data,m,t),this.selectResult=m,this.selectError=null}catch(T){this.selectError=T}else m=c.data;if(typeof t.placeholderData<"u"&&typeof m>"u"&&f==="loading"){let T;if(i!=null&&i.isPlaceholderData&&t.placeholderData===(a==null?void 0:a.placeholderData))T=i.data;else if(T=typeof t.placeholderData=="function"?t.placeholderData():t.placeholderData,t.select&&typeof T<"u")try{T=t.select(T),this.selectError=null}catch(G){this.selectError=G}typeof T<"u"&&(f="success",m=ee(i==null?void 0:i.data,T,t),w=!0)}this.selectError&&(E=this.selectError,m=this.selectResult,x=Date.now(),f="error");const R=g==="fetching",b=f==="loading",S=f==="error";return{status:f,fetchStatus:g,isLoading:b,isSuccess:f==="success",isError:S,isInitialLoading:b&&R,data:m,dataUpdatedAt:v,error:E,errorUpdatedAt:x,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>d.dataUpdateCount||c.errorUpdateCount>d.errorUpdateCount,isFetching:R,isRefetching:R&&!b,isLoadingError:S&&c.dataUpdatedAt===0,isPaused:g==="paused",isPlaceholderData:w,isPreviousData:y,isRefetchError:S&&c.dataUpdatedAt!==0,isStale:B(e,t),refetch:this.refetch,remove:this.remove}}updateResult(e){const t=this.currentResult,s=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,D(s,t))return;this.currentResult=s;const n={cache:!0},i=()=>{if(!t)return!0;const{notifyOnChangeProps:o}=this.options,a=typeof o=="function"?o():o;if(a==="all"||!a&&!this.trackedProps.size)return!0;const h=new Set(a??this.trackedProps);return this.options.useErrorBoundary&&h.add("error"),Object.keys(this.currentResult).some(d=>{const u=d;return this.currentResult[u]!==t[u]&&h.has(u)})};(e==null?void 0:e.listeners)!==!1&&i()&&(n.listeners=!0),this.notify({...n,...e})}updateQuery(){const e=this.client.getQueryCache().build(this.client,this.options);if(e===this.currentQuery)return;const t=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))}onQueryUpdate(e){const t={};e.type==="success"?t.onSuccess=!e.manual:e.type==="error"&&!Je(e.error)&&(t.onError=!0),this.updateResult(t),this.hasListeners()&&this.updateTimers()}notify(e){C.batch(()=>{if(e.onSuccess){var t,s,n,i;(t=(s=this.options).onSuccess)==null||t.call(s,this.currentResult.data),(n=(i=this.options).onSettled)==null||n.call(i,this.currentResult.data,null)}else if(e.onError){var o,a,h,d;(o=(a=this.options).onError)==null||o.call(a,this.currentResult.error),(h=(d=this.options).onSettled)==null||h.call(d,void 0,this.currentResult.error)}e.listeners&&this.listeners.forEach(({listener:u})=>{u(this.currentResult)}),e.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function rt(r,e){return e.enabled!==!1&&!r.state.dataUpdatedAt&&!(r.state.status==="error"&&e.retryOnMount===!1)}function re(r,e){return rt(r,e)||r.state.dataUpdatedAt>0&&j(r,e,e.refetchOnMount)}function j(r,e,t){if(e.enabled!==!1){const s=typeof t=="function"?t(r):t;return s==="always"||s!==!1&&B(r,e)}return!1}function se(r,e,t,s){return t.enabled!==!1&&(r!==e||s.enabled===!1)&&(!t.suspense||r.state.status!=="error")&&B(r,t)}function B(r,e){return r.isStaleByTime(e.staleTime)}function st(r,e,t){return t.keepPreviousData?!1:t.placeholderData!==void 0?e.isPlaceholderData:!D(r.getCurrentResult(),e)}var ye={exports:{}},me={};const nt=Be(Me);/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _=nt;function it(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var ot=typeof Object.is=="function"?Object.is:it,at=_.useState,ut=_.useEffect,ct=_.useLayoutEffect,lt=_.useDebugValue;function ht(r,e){var t=e(),s=at({inst:{value:t,getSnapshot:e}}),n=s[0].inst,i=s[1];return ct(function(){n.value=t,n.getSnapshot=e,Q(n)&&i({inst:n})},[r,t,e]),ut(function(){return Q(n)&&i({inst:n}),r(function(){Q(n)&&i({inst:n})})},[r]),lt(t),t}function Q(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!ot(r,t)}catch{return!0}}function ft(r,e){return e()}var dt=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ft:ht;me.useSyncExternalStore=_.useSyncExternalStore!==void 0?_.useSyncExternalStore:dt;ye.exports=me;var pt=ye.exports;const yt=pt.useSyncExternalStore,ne=I(void 0),ge=I(!1);function Te(r,e){return r||(e&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=ne),window.ReactQueryClientContext):ne)}const mt=({context:r}={})=>{const e=O(Te(r,O(ge)));if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},fr=({client:r,children:e,context:t,contextSharing:s=!1})=>{K(()=>(r.mount(),()=>{r.unmount()}),[r]);const n=Te(t,s);return z(ge.Provider,{value:!t&&s},z(n.Provider,{value:r},e))},ve=I(!1),gt=()=>O(ve);ve.Provider;function Tt(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}const vt=I(Tt()),Et=()=>O(vt);function Rt(r,e){return typeof r=="function"?r(...e):!!r}const wt=(r,e)=>{(r.suspense||r.useErrorBoundary)&&(e.isReset()||(r.retryOnMount=!1))},xt=r=>{K(()=>{r.clearReset()},[r])},bt=({result:r,errorResetBoundary:e,useErrorBoundary:t,query:s})=>r.isError&&!e.isReset()&&!r.isFetching&&Rt(t,[r.error,s]),Pt=r=>{r.suspense&&typeof r.staleTime!="number"&&(r.staleTime=1e3)},_t=(r,e)=>r.isLoading&&r.isFetching&&!e,St=(r,e,t)=>(r==null?void 0:r.suspense)&&_t(e,t),Ct=(r,e,t)=>e.fetchOptimistic(r).then(({data:s})=>{r.onSuccess==null||r.onSuccess(s),r.onSettled==null||r.onSettled(s,null)}).catch(s=>{t.clearReset(),r.onError==null||r.onError(s),r.onSettled==null||r.onSettled(void 0,s)});function Lt(r,e){const t=mt({context:r.context}),s=gt(),n=Et(),i=t.defaultQueryOptions(r);i._optimisticResults=s?"isRestoring":"optimistic",i.onError&&(i.onError=C.batchCalls(i.onError)),i.onSuccess&&(i.onSuccess=C.batchCalls(i.onSuccess)),i.onSettled&&(i.onSettled=C.batchCalls(i.onSettled)),Pt(i),wt(i,n),xt(n);const[o]=ie(()=>new e(t,i)),a=o.getOptimisticResult(i);if(yt(oe(h=>{const d=s?()=>{}:o.subscribe(C.batchCalls(h));return o.updateResult(),d},[o,s]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),K(()=>{o.setOptions(i,{listeners:!1})},[i,o]),St(i,a,s))throw Ct(i,o,n);if(bt({result:a,errorResetBoundary:n,useErrorBoundary:i.useErrorBoundary,query:o.getCurrentQuery()}))throw a.error;return i.notifyOnChangeProps?a:o.trackResult(a)}function Ee(r,e,t){const s=He(r,e,t);return Lt(s,tt)}class Mt extends Oe{constructor(){super()}getType(){return"text"}readFeature(e,t){return this.readFeatureFromText(M(e),this.adaptOptions(t))}readFeatureFromText(e,t){return P()}readFeatures(e,t){return this.readFeaturesFromText(M(e),this.adaptOptions(t))}readFeaturesFromText(e,t){return P()}readGeometry(e,t){return this.readGeometryFromText(M(e),this.adaptOptions(t))}readGeometryFromText(e,t){return P()}readProjection(e){return this.readProjectionFromText(M(e))}readProjectionFromText(e){return this.dataProjection}writeFeature(e,t){return this.writeFeatureText(e,this.adaptOptions(t))}writeFeatureText(e,t){return P()}writeFeatures(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))}writeFeaturesText(e,t){return P()}writeGeometry(e,t){return this.writeGeometryText(e,this.adaptOptions(t))}writeGeometryText(e,t){return P()}}function M(r){return typeof r=="string"?r:""}const Ot=Mt,Ft={POINT:Fe,LINESTRING:Ie,POLYGON:Ne,MULTIPOINT:Ge,MULTILINESTRING:Qe,MULTIPOLYGON:ke},Re="EMPTY",we="Z",xe="M",It="ZM",l={START:0,TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6},Nt={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"};class Gt{constructor(e){this.wkt=e,this.index_=-1}isAlpha_(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}isNumeric_(e,t){return t=t!==void 0?t:!1,e>="0"&&e<="9"||e=="."&&!t}isWhiteSpace_(e){return e==" "||e=="	"||e=="\r"||e==`
`}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const e=this.nextChar_(),t=this.index_;let s=e,n;if(e=="(")n=l.LEFT_PAREN;else if(e==",")n=l.COMMA;else if(e==")")n=l.RIGHT_PAREN;else if(this.isNumeric_(e)||e=="-")n=l.NUMBER,s=this.readNumber_();else if(this.isAlpha_(e))n=l.TEXT,s=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(e==="")n=l.EOF;else throw new Error("Unexpected character: "+e)}return{position:t,value:s,type:n}}readNumber_(){let e;const t=this.index_;let s=!1,n=!1;do e=="."?s=!0:(e=="e"||e=="E")&&(n=!0),e=this.nextChar_();while(this.isNumeric_(e,s)||!n&&(e=="e"||e=="E")||n&&(e=="-"||e=="+"));return parseFloat(this.wkt.substring(t,this.index_--))}readText_(){let e;const t=this.index_;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(t,this.index_--).toUpperCase()}}class Qt{constructor(e){this.lexer_=e,this.token_={position:0,type:l.START},this.layout_="XY"}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(e){return this.token_.type==e}match(e){const t=this.isTokenType(e);return t&&this.consume_(),t}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let e="XY";const t=this.token_;if(this.isTokenType(l.TEXT)){const s=t.value;s===we?e="XYZ":s===xe?e="XYM":s===It&&(e="XYZM"),e!=="XY"&&this.consume_()}return e}parseGeometryCollectionText_(){if(this.match(l.LEFT_PAREN)){const e=[];do e.push(this.parseGeometry_());while(this.match(l.COMMA));if(this.match(l.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(l.LEFT_PAREN)){const e=this.parsePoint_();if(this.match(l.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(l.LEFT_PAREN)){const e=this.parsePointList_();if(this.match(l.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(l.LEFT_PAREN)){const e=this.parseLineStringTextList_();if(this.match(l.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(l.LEFT_PAREN)){let e;if(this.token_.type==l.LEFT_PAREN?e=this.parsePointTextList_():e=this.parsePointList_(),this.match(l.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(l.LEFT_PAREN)){const e=this.parseLineStringTextList_();if(this.match(l.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(l.LEFT_PAREN)){const e=this.parsePolygonTextList_();if(this.match(l.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePoint_(){const e=[],t=this.layout_.length;for(let s=0;s<t;++s){const n=this.token_;if(this.match(l.NUMBER))e.push(n.value);else break}if(e.length==t)return e;throw new Error(this.formatErrorMessage_())}parsePointList_(){const e=[this.parsePoint_()];for(;this.match(l.COMMA);)e.push(this.parsePoint_());return e}parsePointTextList_(){const e=[this.parsePointText_()];for(;this.match(l.COMMA);)e.push(this.parsePointText_());return e}parseLineStringTextList_(){const e=[this.parseLineStringText_()];for(;this.match(l.COMMA);)e.push(this.parseLineStringText_());return e}parsePolygonTextList_(){const e=[this.parsePolygonText_()];for(;this.match(l.COMMA);)e.push(this.parsePolygonText_());return e}isEmptyGeometry_(){const e=this.isTokenType(l.TEXT)&&this.token_.value==Re;return e&&this.consume_(),e}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const e=this.token_;if(this.match(l.TEXT)){const t=e.value;this.layout_=this.parseGeometryLayout_();const s=this.isEmptyGeometry_();if(t=="GEOMETRYCOLLECTION"){if(s)return new k([]);const o=this.parseGeometryCollectionText_();return new k(o)}const n=Ft[t];if(!n)throw new Error("Invalid geometry type: "+t);let i;if(s)t=="POINT"?i=[NaN,NaN]:i=[];else switch(t){case"POINT":{i=this.parsePointText_();break}case"LINESTRING":{i=this.parseLineStringText_();break}case"POLYGON":{i=this.parsePolygonText_();break}case"MULTIPOINT":{i=this.parseMultiPointText_();break}case"MULTILINESTRING":{i=this.parseMultiLineStringText_();break}case"MULTIPOLYGON":{i=this.parseMultiPolygonText_();break}}return new n(i,this.layout_)}throw new Error(this.formatErrorMessage_())}}class kt extends Ot{constructor(e){super(),e=e||{},this.splitCollection_=e.splitCollection!==void 0?e.splitCollection:!1}parse_(e){const t=new Gt(e);return new Qt(t).parse()}readFeatureFromText(e,t){const s=this.readGeometryFromText(e,t),n=new X;return n.setGeometry(s),n}readFeaturesFromText(e,t){let s=[];const n=this.readGeometryFromText(e,t);this.splitCollection_&&n.getType()=="GeometryCollection"?s=n.getGeometriesArray():s=[n];const i=[];for(let o=0,a=s.length;o<a;++o){const h=new X;h.setGeometry(s[o]),i.push(h)}return i}readGeometryFromText(e,t){const s=this.parse_(e);return H(s,!1,t)}writeFeatureText(e,t){const s=e.getGeometry();return s?this.writeGeometryText(s,t):""}writeFeaturesText(e,t){if(e.length==1)return this.writeFeatureText(e[0],t);const s=[];for(let i=0,o=e.length;i<o;++i)s.push(e[i].getGeometry());const n=new k(s);return this.writeGeometryText(n,t)}writeGeometryText(e,t){return _e(H(e,!0,t))}}function be(r){const e=r.getCoordinates();return e.length===0?"":e.join(" ")}function At(r){const e=[],t=r.getPoints();for(let s=0,n=t.length;s<n;++s)e.push("("+be(t[s])+")");return e.join(",")}function Dt(r){const e=[],t=r.getGeometries();for(let s=0,n=t.length;s<n;++s)e.push(_e(t[s]));return e.join(",")}function $(r){const e=r.getCoordinates(),t=[];for(let s=0,n=e.length;s<n;++s)t.push(e[s].join(" "));return t.join(",")}function Ut(r){const e=[],t=r.getLineStrings();for(let s=0,n=t.length;s<n;++s)e.push("("+$(t[s])+")");return e.join(",")}function Pe(r){const e=[],t=r.getLinearRings();for(let s=0,n=t.length;s<n;++s)e.push("("+$(t[s])+")");return e.join(",")}function jt(r){const e=[],t=r.getPolygons();for(let s=0,n=t.length;s<n;++s)e.push("("+Pe(t[s])+")");return e.join(",")}function Kt(r){const e=r.getLayout();let t="";return(e==="XYZ"||e==="XYZM")&&(t+=we),(e==="XYM"||e==="XYZM")&&(t+=xe),t}const Yt={Point:be,LineString:$,Polygon:Pe,MultiPoint:At,MultiLineString:Ut,MultiPolygon:jt,GeometryCollection:Dt};function _e(r){const e=r.getType(),t=Yt[e],s=t(r);let n=Nt[e];if(typeof r.getFlatCoordinates=="function"){const i=Kt(r);i.length>0&&(n+=" "+i)}return s.length===0?n+" "+Re:n+"("+s+")"}const Bt=kt,Se="https://www.planning.data.gov.uk",Ce=()=>Ee(["datasets"],()=>fetch(`${Se}/dataset.json`).then(r=>r.json()),{select:r=>r.datasets.sort((e,t)=>e.name.localeCompare(t.name))}),$t=async(r,e)=>{if(!r)return{features:[]};const s=new Bt().writeGeometry(r);let n=e?`&dataset=${e}`:"";return await fetch(`${Se}/entity.geojson?limit=100&geometry=${s}${n}&geometry_relation=intersects`).then(i=>i.json())},qt=(r,e)=>Ee(["entities",e,r],()=>$t(r,e)),Xt=({item:r,selected:e,onSelect:t})=>{const s=L(()=>`${r.dataset}-checkbox`,[r]);return p("div",{className:"flex items-center mb-4",children:[p("input",{id:s,className:"h-5 w-5 flex-none cursor-pointer",type:"checkbox",checked:e,onChange:()=>t(r.dataset)}),p("label",{htmlFor:s,className:"ml-2 font-semibold cursor-pointer",children:r.name})]},r.dataset)},Ht=({title:r="Data Layers",items:e,selectedItems:t,onSelect:s,isLoading:n=!1})=>{const i=oe(a=>t.includes(a),[t]),o=e.map(a=>p(Xt,{item:a,selected:i(a.dataset),onSelect:s},a.dataset));return p("div",{className:"flex flex-col border h-full overflow-hidden",children:[p("div",{className:"text-xl font-bold border-b p-2",children:r}),p("div",{className:"pt-2 px-2 overflow-y-auto overscroll-none grow flex flex-col",children:n?p("div",{className:"text-center flex flex-col justify-center grow",children:"Loading..."}):o})]})},zt=({selectedDatasets:r,datasetFilterList:e,onSelectDataset:t})=>{const{data:s,isLoading:n}=Ce(),i=L(()=>s?e&&e.length?s.filter(o=>e.includes(o.dataset)):s:[],[e,s]);return p("div",{className:"dataset-control",children:p(Ht,{items:i,selectedItems:r,onSelect:t,isLoading:n})})},Zt=({area:r,dataset:e,zIndex:t=1})=>{const{data:s,isLoading:n,isError:i}=qt(r,e.dataset);if(n||i)return null;const o=L(()=>({color:e["paint-options"]?e["paint-options"].colour:"#003078",width:2}),[e]),a=L(()=>{const h=e["paint-options"];if(!h)return{color:"rgba(0, 48, 120, 0.2)"};const{colour:d,opacity:u}=h,c=parseInt(d.slice(1,3),16),v=parseInt(d.slice(3,5),16),E=parseInt(d.slice(5,7),16);return{color:`rgb(${c}, ${v}, ${E}, ${u||.2})`}},[e]);return p(Ae,{features:s,stroke:o,fill:a,zIndex:t})},Wt=({selectedDatasets:r})=>{const e=De(),{data:t}=Ce(),s=L(()=>(t==null?void 0:t.filter(o=>r.includes(o.dataset)))??[],[r,t]),n=Ue(e.getView().calculateExtent(e.getSize())),i=s.map(o=>p(Zt,{dataset:o,area:n},o.dataset));return p($e,{children:i})};const Vt={strokeColor:"#DD6970",fillColor:"rgba(221, 105, 112, 0.1)",strokeWidth:2,vertexPoints:4,vertexRadius:5,pointerStrokeColor:"white",pointerFillColor:"#DD6970",pointerRadius:5},Jt={isDrawingMode:!0,lat:54.97,lng:-1.65,zoom:10},dr=({id:r,className:e,style:t={height:"700px",width:"100%"},showDatasets:s=!0,datasetFilterList:n,value:i,onChange:o,baseMapProps:a,drawingMapProps:h})=>{const d={...Vt,...h},u={...Jt,...a},[c,v]=ie([]),E=g=>{c.includes(g)?v(c.filter(f=>f!==g)):v([...c,g])},x=`map-container ${e}`;return p(Ye,{id:r,className:x,style:t,children:[p(je,{lat:u.lat,lng:u.lng,zoom:u.zoom,style:{height:"100%",width:"100%"}}),p("div",{className:"map-controls",children:s&&p(zt,{selectedDatasets:c,onSelectDataset:E,datasetFilterList:n})}),u.isDrawingMode&&p(Ke,{...d,value:i,onChange:o}),s&&p(Wt,{selectedDatasets:c})]})};export{dr as M,fr as Q,Y as S,F as a,C as b,hr as c,Je as d,de as e,cr as f,lr as g,ze as h,Z as i,he as j,He as k,or as l,ur as m,qe as n,fe as o,ar as p,A as q,ee as r,ae as s,Xe as t,qt as u};
//# sourceMappingURL=MapComponent-fa6d55dc.js.map
